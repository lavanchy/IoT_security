<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Using ATECC508A for Node Authentication: Node authentication stages for node-auth-basic example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Using ATECC508A for Node Authentication
   </div>
   <div id="projectbrief">All-in-one project - Asymmetric Node Authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00024.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Node authentication stages for node-auth-basic example</div>  </div>
</div><!--header-->
<div class="contents">

<p>These methods implement each phase of the authentication example. If you would like to follow a particular phase with a code walk through, you can follow each of the phases from client-provision through host-verify-resp. Each phase is initiated with a console command so you can control the progress through the example.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga57145f58fcb69a164d7cf37c77490b5e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga57145f58fcb69a164d7cf37c77490b5e">client_rebuild_certs</a> (void)</td></tr>
<tr class="memdesc:ga57145f58fcb69a164d7cf37c77490b5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This client role method demonstrates how to read cert data stored in the ATECC508A and reconstruct a full X.509 cert in DER format. Because this is an example, it prints the reconstructed cert data to the console in ASCII hex format.  <a href="#ga57145f58fcb69a164d7cf37c77490b5e">More...</a><br /></td></tr>
<tr class="separator:ga57145f58fcb69a164d7cf37c77490b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83dceb559e26b1946a13fcceff82c138"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga83dceb559e26b1946a13fcceff82c138">host_verify_cert_chain</a> (void)</td></tr>
<tr class="memdesc:ga83dceb559e26b1946a13fcceff82c138"><td class="mdescLeft">&#160;</td><td class="mdescRight">This host role method demonstrates how to do a chain verify. In this example, there is a root certificate authority which signed the signer's cert. The signer signed the device cert. The chain verification performs an ECDSA verification of each link in the cert chain. This verifies that the device has been properly signed into the chain starting from the CA root of trust (RoT).  <a href="#ga83dceb559e26b1946a13fcceff82c138">More...</a><br /></td></tr>
<tr class="separator:ga83dceb559e26b1946a13fcceff82c138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b1bcda6324c25f4b672dda4f7503663"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga1b1bcda6324c25f4b672dda4f7503663">host_generate_challenge</a> (void)</td></tr>
<tr class="memdesc:ga1b1bcda6324c25f4b672dda4f7503663"><td class="mdescLeft">&#160;</td><td class="mdescRight">This host role method generates a challenge to be signed by the CryptoAuth device. This challenge is basically a random number that once signed can be verified by the host.  <a href="#ga1b1bcda6324c25f4b672dda4f7503663">More...</a><br /></td></tr>
<tr class="separator:ga1b1bcda6324c25f4b672dda4f7503663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3eae025b8eeebc6d44891ec02a50738"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#gad3eae025b8eeebc6d44891ec02a50738">client_generate_response</a> (void)</td></tr>
<tr class="memdesc:gad3eae025b8eeebc6d44891ec02a50738"><td class="mdescLeft">&#160;</td><td class="mdescRight">This client role method signs the challenge and returns the signature to the host. For example purposes, the signature is contained in a global variable g_response.  <a href="#gad3eae025b8eeebc6d44891ec02a50738">More...</a><br /></td></tr>
<tr class="separator:gad3eae025b8eeebc6d44891ec02a50738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d40f30096da970e25ce4d17af8c7598"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga3d40f30096da970e25ce4d17af8c7598">host_verify_response</a> (void)</td></tr>
<tr class="memdesc:ga3d40f30096da970e25ce4d17af8c7598"><td class="mdescLeft">&#160;</td><td class="mdescRight">This host role method verifies the signature of the challenge. This step insures that the device can prove it owns the private key associated with the public key of its certificate. Since the certificate is verified to be in a root of trust certificate chain, this ECDSA verification step makes sure the public key the device says it has is truly owned by the device and not a forgery.  <a href="#ga3d40f30096da970e25ce4d17af8c7598">More...</a><br /></td></tr>
<tr class="separator:ga3d40f30096da970e25ce4d17af8c7598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8d2a629ed167217b0362b93cfe3e124"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#gac8d2a629ed167217b0362b93cfe3e124">client_provision</a> (void)</td></tr>
<tr class="memdesc:gac8d2a629ed167217b0362b93cfe3e124"><td class="mdescLeft">&#160;</td><td class="mdescRight">entry point called from the console interaction to provision the client side certs and device key. This is a self-contained example of the provisioning process that would normally happen at the factory using high security modules (HSM) and production facilities. This is functional code which can be used to self-provisioin a device for illustration, example, or demo purposes.  <a href="#gac8d2a629ed167217b0362b93cfe3e124">More...</a><br /></td></tr>
<tr class="separator:gac8d2a629ed167217b0362b93cfe3e124"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gac797fb78284b6b1bf0b3398c6c5f5dcd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#gac797fb78284b6b1bf0b3398c6c5f5dcd">g_signer_cert</a> [1024]</td></tr>
<tr class="memdesc:gac797fb78284b6b1bf0b3398c6c5f5dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">global storage for signer certificate  <a href="#gac797fb78284b6b1bf0b3398c6c5f5dcd">More...</a><br /></td></tr>
<tr class="separator:gac797fb78284b6b1bf0b3398c6c5f5dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2984b45223d0a55dc1428767162ff446"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga2984b45223d0a55dc1428767162ff446">g_signer_cert_size</a> = sizeof(<a class="el" href="a00024.html#gac797fb78284b6b1bf0b3398c6c5f5dcd">g_signer_cert</a>)</td></tr>
<tr class="separator:ga2984b45223d0a55dc1428767162ff446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga761b0b0d5d8d91b30450d7ee15a11ca2"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga761b0b0d5d8d91b30450d7ee15a11ca2">g_device_cert</a> [1024]</td></tr>
<tr class="memdesc:ga761b0b0d5d8d91b30450d7ee15a11ca2"><td class="mdescLeft">&#160;</td><td class="mdescRight">global storage for device certificate  <a href="#ga761b0b0d5d8d91b30450d7ee15a11ca2">More...</a><br /></td></tr>
<tr class="separator:ga761b0b0d5d8d91b30450d7ee15a11ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga011cfdf59253514d1e5ba811c02591eb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga011cfdf59253514d1e5ba811c02591eb">g_device_cert_size</a> = sizeof(<a class="el" href="a00024.html#ga761b0b0d5d8d91b30450d7ee15a11ca2">g_device_cert</a>)</td></tr>
<tr class="separator:ga011cfdf59253514d1e5ba811c02591eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab12ca35f9ec607b3f0cf719dd3c381fb"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#gab12ca35f9ec607b3f0cf719dd3c381fb">g_challenge</a> [32]</td></tr>
<tr class="memdesc:gab12ca35f9ec607b3f0cf719dd3c381fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">global storage for the challenge data to sign by the device  <a href="#gab12ca35f9ec607b3f0cf719dd3c381fb">More...</a><br /></td></tr>
<tr class="separator:gab12ca35f9ec607b3f0cf719dd3c381fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f4a5ba129896f1e901dee5feba5d985"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html#ga1f4a5ba129896f1e901dee5feba5d985">g_response</a> [64]</td></tr>
<tr class="separator:ga1f4a5ba129896f1e901dee5feba5d985"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These methods implement each phase of the authentication example. If you would like to follow a particular phase with a code walk through, you can follow each of the phases from client-provision through host-verify-resp. Each phase is initiated with a console command so you can control the progress through the example. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gad3eae025b8eeebc6d44891ec02a50738"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int client_generate_response </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This client role method signs the challenge and returns the signature to the host. For example purposes, the signature is contained in a global variable g_response. </p>

</div>
</div>
<a class="anchor" id="gac8d2a629ed167217b0362b93cfe3e124"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int client_provision </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>entry point called from the console interaction to provision the client side certs and device key. This is a self-contained example of the provisioning process that would normally happen at the factory using high security modules (HSM) and production facilities. This is functional code which can be used to self-provisioin a device for illustration, example, or demo purposes. </p>

</div>
</div>
<a class="anchor" id="ga57145f58fcb69a164d7cf37c77490b5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int client_rebuild_certs </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This client role method demonstrates how to read cert data stored in the ATECC508A and reconstruct a full X.509 cert in DER format. Because this is an example, it prints the reconstructed cert data to the console in ASCII hex format. </p>

</div>
</div>
<a class="anchor" id="ga1b1bcda6324c25f4b672dda4f7503663"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int host_generate_challenge </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This host role method generates a challenge to be signed by the CryptoAuth device. This challenge is basically a random number that once signed can be verified by the host. </p>

</div>
</div>
<a class="anchor" id="ga83dceb559e26b1946a13fcceff82c138"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int host_verify_cert_chain </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This host role method demonstrates how to do a chain verify. In this example, there is a root certificate authority which signed the signer's cert. The signer signed the device cert. The chain verification performs an ECDSA verification of each link in the cert chain. This verifies that the device has been properly signed into the chain starting from the CA root of trust (RoT). </p>

</div>
</div>
<a class="anchor" id="ga3d40f30096da970e25ce4d17af8c7598"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int host_verify_response </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This host role method verifies the signature of the challenge. This step insures that the device can prove it owns the private key associated with the public key of its certificate. Since the certificate is verified to be in a root of trust certificate chain, this ECDSA verification step makes sure the public key the device says it has is truly owned by the device and not a forgery. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gab12ca35f9ec607b3f0cf719dd3c381fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t g_challenge[32]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>global storage for the challenge data to sign by the device </p>

</div>
</div>
<a class="anchor" id="ga761b0b0d5d8d91b30450d7ee15a11ca2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t g_device_cert[1024]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>global storage for device certificate </p>

</div>
</div>
<a class="anchor" id="ga011cfdf59253514d1e5ba811c02591eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t g_device_cert_size = sizeof(<a class="el" href="a00024.html#ga761b0b0d5d8d91b30450d7ee15a11ca2">g_device_cert</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga1f4a5ba129896f1e901dee5feba5d985"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t g_response[64]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gac797fb78284b6b1bf0b3398c6c5f5dcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t g_signer_cert[1024]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>global storage for signer certificate </p>

</div>
</div>
<a class="anchor" id="ga2984b45223d0a55dc1428767162ff446"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t g_signer_cert_size = sizeof(<a class="el" href="a00024.html#gac797fb78284b6b1bf0b3398c6c5f5dcd">g_signer_cert</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
